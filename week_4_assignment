

1. Pull total number of orders that were completed on 18th March 2023 with the first name ‘John’ and last name Doe’

select count(order_id) from sales as s 
join customers as c on c.customer_id = s.customer_id 
where s.date = '2023-03-28' and c.first_name = 'John' and c.last_name = 'Doe';


2. Pull total number of customers that purchased in January 2023 and the average amount spend per customer

select count(distinct customer_id), avg(revenue) as ave_rev
from sales
where date between '2023-01-01' and '2023-01-31';


3. Pull the departments that generated less than $600 in 2022

select department, sum(revenue)
from items
join sales on sales.item_id = items.item_id
where date between '2022-01-01' and  '2022-12-31'
group by department
having sum(revenue)<600;


4. What is the most and least revenue we have generated by an order

select max(revenue), min(revenue) from sales;


5. What were the orders that were purchased in our most lucrative order

select * from sales where revenue=(select max(revenue) from sales);
